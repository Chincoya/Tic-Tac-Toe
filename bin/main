#!/usr/bin/env ruby
# frozen_string_literal: true

require './lib/logic.rb'

class TicTacInterface
  def initialize
    @engine = TicTacLogic.new
    begin
      puts `clear`
      p "What's your name, player 1?"
      @engine.player1 = gets.chomp
      puts `clear`
      p "What's your name, player 2?"
      @engine.player2 = gets.chomp
      puts `clear`
    rescue StandardError => e
      p "No name given #{e}"
      sleep 1
      retry
    end
  end

  def game
    paint
    p "Please #{@engine.playert ? @engine.player1 : @engine.player2}, make a move"
    while @engine.play
      until @engine.move(gets.chomp.to_i)
        p "Please, #{@engine.playert ? @engine.player1 : @engine.player2}, type the number of an avaiable spot."
      end
      paint
      p @engine.game_end?
    end
  end

  private

  def paint
    puts `clear`
    p '||||||||||||||||||||||'
    3.times do |x|
      p "        #{@engine.board[(3 * x)]} #{@engine.board[(3 * x) + 1]} #{@engine.board[(3 * x) + 2]}"
    end
    p '||||||||||||||||||||||'
  end
end

main = TicTacInterface.new
main.game
